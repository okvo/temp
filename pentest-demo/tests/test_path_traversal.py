import os
from scenarios.path_traversal.run import read_file_safe, read_file_vuln, BASE_DIR

def test_safe_rejects_traversal():
    # attempt to traverse outside the base dir
    bad = "../" + os.path.basename(__file__)  # a harmless attempt
    try:
        read_file_safe(bad)
        assert False, "safe reader should have rejected traversal"
    except ValueError:
        assert True

def test_vuln_throws_file_not_found_for_nonexistent():
    # vuln version just attempts to open the path and will raise FileNotFoundError if path doesn't exist
    try:
        read_file_vuln("no_such_file.txt")
    except FileNotFoundError:
        assert True
