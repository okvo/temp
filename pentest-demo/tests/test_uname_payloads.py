"""
Consolidated suite for uname-style payloads.
Each test has a valid Python name but asserts the raw payload string
(literally including $(), backticks, semicolons, pipes and the original spaced filename).
"""

def test_dollar_paren_uname():
    payload = "test_$(uname).py"
    # raw payload must be present literally
    assert "$(uname)" in payload
    assert payload.startswith("test_$(")
    assert payload.endswith(").py")

def test_backtick_uname():
    payload = "test_`uname`.py"
    assert "`uname`" in payload
    assert payload.startswith("test_`")
    assert payload.endswith("`.py")

def test_semicolon_uname():
    payload = "test_;uname;.py"
    assert ";uname;" in payload
    assert payload.count(";") >= 2

def test_pipe_uname():
    payload = "test_||uname||.py"
    assert "||uname||" in payload
    assert payload.count("|") >= 4

def test_space_filename_original():
    payload = "test.py id test.py"
    assert payload == "test.py id test.py"
