from scenarios.xss_flask.run import app, NOTES
import pytest

@pytest.fixture
def client():
    return app.test_client()

def test_safe_route_escapes(client):
    NOTES["1"] = "<script>alert('x')</script>"
    rv = client.get("/note/1/safe")
    assert b"<script>alert" not in rv.data  # content must be escaped

def test_vuln_route_reflects(client):
    NOTES["1"] = "<b>bold</b>"
    rv = client.get("/note/1/vuln")
    assert b"<b>bold</b>" in rv.data
