import logging

logger = logging.getLogger("demo")
logger.setLevel(logging.INFO)
handler = logging.StreamHandler()
logger.addHandler(handler)


def unsafe_log(config):
    # VULN: logging entire config object (may contain secrets)
    logger.info("Full config: %s", config)


def safe_log(config):
    sanitized = {k: (v if not k.lower().startswith("secret") and not k.lower().startswith("api") and not k.lower().endswith("pass") else "<redacted>") for k, v in config.items()}
    logger.info("Sanitized config: %s", sanitized)


def run(safe_mode=True):
    config = {"db_pass": "s3cr3t", "api_key": "FAKE_KEY_12345", "mode": "dev"}
    if safe_mode:
        print("Running SAFE logging (sanitized)")
        safe_log(config)
    else:
        print("Running UNSAFE logging (demonstration only)")
        unsafe_log(config)
